<div class="contenedor-principal">
    <h2 mat-dialog-title class="titulo">Consultar Pagos</h2>

    <!-- Contenedor superior dividido en dos columnas -->
    <div class="contenedor-superior">
        <!-- Información del cliente -->
        <div class="card info-cliente" *ngIf="dataInicio">
            <h3 class="subtitulo">Informacion</h3>
            <p><strong>Total de pagos:</strong> {{ dataInicio.length }}</p>
            <p><strong>Cliente:</strong> {{ NombreCliente }}</p>
        </div>

        
        <!-- Formulario de búsqueda -->
        <div class="card formulario-busqueda">
            <h3 class="subtitulo">Búsqueda</h3>
            <form [formGroup]="formularioVenta" (ngSubmit)="buscarCompra()">
                <div class="formulario-grupo">

                    <mat-form-field appearance="fill" class="campo-busqueda">
                        <mat-label>Buscar por</mat-label>
                        <mat-select [(value)]="Selector" (selectionChange)="onSelectChange($event)">
                            <mat-option value="id">
                                <mat-icon class="icono-compra">mail</mat-icon> Correo
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field appearance="fill" class="campo-id">
                        <mat-label>Correo del cliente</mat-label>
                        <input matInput autocomplete="off" formControlName="correo" type="email">
                        <mat-icon matSuffix>mail</mat-icon>
                        <mat-error *ngIf="formularioVenta.get('correo')?.hasError('email')">
                            Ingrese un correo válido
                        </mat-error>
                    </mat-form-field>

                </div>


                <button mat-flat-button class="agregar" type="submit" [disabled]="formularioVenta.invalid">
                    <mat-icon>search</mat-icon> Buscar
                </button>
            </form>
        </div>
    </div>

    <!-- Tabla de productos -->
    <div class="table-container" *ngIf="dataListaVenta">
        <h3 class="subtitulo">Detalle de pago</h3>
        <table mat-table [dataSource]="dataListaVenta" class="mat-elevation-z2 full-width-table">

            <ng-container matColumnDef="idPago">
                <th mat-header-cell *matHeaderCellDef># Pago</th>
                <td mat-cell *matCellDef="let element">{{ element.idPago }}</td>
            </ng-container>

            <ng-container matColumnDef="nombreUsuario">
                <th mat-header-cell *matHeaderCellDef>Cliente</th>
                <td mat-cell *matCellDef="let element">{{ element.nombreUsuario }}</td>
            </ng-container>

            <ng-container matColumnDef="fechaPago">
                <th mat-header-cell *matHeaderCellDef>Fecha de Pago</th>
                <td mat-cell *matCellDef="let element">{{ formatearFecha(element.fechaPago) }}</td>
            </ng-container>

            <ng-container matColumnDef="tipoPago">
                <th mat-header-cell *matHeaderCellDef>Tipo de Pago</th>
                <td mat-cell *matCellDef="let element">{{ element.tipoPago }}</td>
            </ng-container>

            <ng-container matColumnDef="tipoTranferencia">
                <th mat-header-cell *matHeaderCellDef>Transferencia</th>
                <td mat-cell *matCellDef="let element">{{ element.tipoTranferencia === 'Sin ningún tipo de pago' ? 'N/A' : element.tipoTranferencia }}</td>
            </ng-container>

            <ng-container matColumnDef="montoTexto">
                <th mat-header-cell *matHeaderCellDef>Monto</th>
                <td mat-cell *matCellDef="let element">{{ (element.montoTexto) }}</td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="columnasTabla"></tr>
            <tr mat-row *matRowDef="let row; columns: columnasTabla;"></tr>
        </table>


        <mat-paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 15]" showFirstLastButtons></mat-paginator>
    </div>
</div>

<footer class="footer">
    <p>Copyright &copy; 2025 - Hecho con orgullo en Colombia. Todos los derechos reservados.</p>
</footer>